<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="clinfun">
<title>Functions For Clinical Trial Design • clinfun</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions For Clinical Trial Design">
<meta property="og:description" content="clinfun">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">clinfun</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/clinical-trial-functions.html">Functions For Clinical Trial Design</a>
    <a class="dropdown-item" href="../articles/compare-trial-functions.html">compare-trial-functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="clinical-trial-functions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions For Clinical Trial Design</h1>
            
      
      
      <div class="d-none name"><code>clinical-trial-functions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette walks through functions in {clinfun} that facilitate the design of clinical trials. Examples using published clinical trials are included to illustrate the use of these functions in a real-world context.</p>
<p>To begin, install and load {clinfun}:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clinfun</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phase-ii-trial-design">Phase II Trial Design<a class="anchor" aria-label="anchor" href="#phase-ii-trial-design"></a>
</h2>
<p>The overall purpose of phase II research is to determine whether a treatment is promising enough to warrant more extensive development. While phase I research assesses safety and clinical pharmacology, phase II research begins assessing the efficacy of a treatment in a well-defined population, while continuing to monitor the safety of the treatment. {clinfun} enables users to construct two common phase II trial designs, Simon’s two-stage and single-stage, which are described in more detail below.</p>
<div class="section level3">
<h3 id="simons-two-stage">Simon’s Two-Stage<a class="anchor" aria-label="anchor" href="#simons-two-stage"></a>
</h3>
<p>The goal of Simon’s two-stage design is to assess the efficacy of a treatment while minimizing the number of patients exposed to an ineffective treatment.</p>
<p>The trial begins by enrolling <span class="math inline">\(n_1\)</span> patients in stage 1. If <span class="math inline">\(\leq r_1\)</span> responses are observed, then early termination occurs, at which point the treatment is not recommended. Otherwise, <span class="math inline">\(n_2\)</span> patients are enrolled in stage 2 and the success of the treatment is based on all data accumulated. At the end of stage 2, if <span class="math inline">\(\leq r\)</span> responses have been observed in total, then the treatment is not recommended; if <span class="math inline">\(&gt;r\)</span> responses have been observed in total, then the treatment is recommended.</p>
<p>When designing a Simon’s two-stage trial, the key objective is to determine appropriate response threshold and sample size values, indicated by:</p>
<ul>
<li><p><span class="math inline">\(r_1\)</span>: Response threshold at the end of stage 1</p></li>
<li><p><span class="math inline">\(r\)</span>: Final response threshold</p></li>
<li><p><span class="math inline">\(n_1\)</span>: Stage 1 sample size</p></li>
<li><p><span class="math inline">\(n\)</span>: Total sample size (<span class="math inline">\(n_1 + n_2\)</span>)</p></li>
</ul>
<div class="section level4">
<h4 id="design-parameters-and-constraints">Design Parameters and Constraints<a class="anchor" aria-label="anchor" href="#design-parameters-and-constraints"></a>
</h4>
<p>In order to determine final design components, the following parameters and constraints must be specified:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): Treatment response rate considered unacceptable</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): Treatment response rate considered desirable</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): Type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): Type II error threshold</p></li>
</ul>
<p>The final design components depend on the response rates considered “unacceptable” (<span class="math inline">\(p_0\)</span>) and “desirable” (<span class="math inline">\(p_1\)</span>) and must satisfy the desired error rate constraints (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) for testing the following hypotheses:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true treatment response rate is less than or equal to some unacceptable level (<span class="math inline">\(p \leq p_0\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true treatment response rate is greater than or equal to some desirable level (<span class="math inline">\(p \geq p_1\)</span>)</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="optimal-vs--minimax-vs--admissible-designs">Optimal vs. Minimax vs. Admissible Designs<a class="anchor" aria-label="anchor" href="#optimal-vs--minimax-vs--admissible-designs"></a>
</h4>
<p>Once the design parameters and constraints are provided, {clinfun} determines the final design components based on three different approaches: optimal, minimax, and admissible.</p>
<p>If early termination occurs, the sample size for the trial is <span class="math inline">\(n_1\)</span>. If early termination does not occur, the sample size for the trial is <span class="math inline">\(n\)</span> (the maximum sample size for the trial).</p>
<p>Thus, the expected sample size under the null hypothesis is given by</p>
<p><span class="math display">\[ EN(p_0) = n_1 + (1 - PET(p_0)) \cdot n_2 \]</span></p>
<p>where <span class="math inline">\(PET(p_0)\)</span> is the probability of early termination under the null hypothesis.</p>
<p>The <strong>optimal design</strong> minimizes the expected sample size (<span class="math inline">\(EN(p_0)\)</span>), whereas the <strong>minimax design</strong> minimizes the maximum sample size (<span class="math inline">\(n_1 + n_2\)</span>). The optimal design typically has a smaller stage 1 sample size but more subjects overall if the trial proceeds to stage 2. The optimal design also typically has a higher <span class="math inline">\(PET(p_0)\)</span> than the minimax design. The minimax design can be preferable in certain scenarios: for example, if <span class="math inline">\(EN(p_0)\)</span> is relatively close to that of the optimal design and the patient accrual rate is slow, or if the patient population is heterogeneous and a small stage 1 is not desirable.</p>
<p>The <strong>admissible design</strong> can be thought of as a compromise between the optimal and minimax designs and is based on a Bayesian decision-theoretic criterion.</p>
</div>
<div class="section level4">
<h4 id="levatinib-phase-ii-trial-example">Levatinib Phase II Trial Example<a class="anchor" aria-label="anchor" href="#levatinib-phase-ii-trial-example"></a>
</h4>
<p>For this example, we will be looking at a phase II trial that assessed the efficacy of lenvatinib in patients with progressive, recurrent or metastatic adenoid cystic carcinoma (Tchekmedyian et al., 2019). Patients received lenvatinib 24 mg/day. Treatment was continued until disease progression, death, unacceptable toxicity, withdrawal of consent, or a decision based on the treating physician’s discretion. Treatment response was specifically defined as overall response: achievement of either partial response or complete response, as defined by Response Evaluation Criteria in Solid Tumors (RECIST) version 1.1.</p>
<p>The trial employed a Simon’s two-stage design. An overall response rate of 5% was considered unacceptable, and an overall response rate of 20% was considered desirable. The type I error threshold used was 10%. The target power used was 90%, equivalent to a 10% type II error threshold.</p>
<p>Summarizing the design parameters and constraints from above, we have:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): 5% overall response rate</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): 20% overall response rate</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): 10% type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): 10% type II error threshold</p></li>
</ul>
<p>Thus, the hypotheses used for testing are:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true overall response rate is less than or equal to 5% (<span class="math inline">\(p \leq 0.05\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true overall response rate is greater than or equal to 20% (<span class="math inline">\(p \geq 0.2%\)</span>)</p></li>
</ul>
<p>Now, using <code><a href="../reference/ph2simon.html">ph2simon()</a></code>, specify these parameters and print the resulting object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the parameters and constraints</span></span>
<span><span class="va">trial</span> <span class="op">=</span> <span class="fu"><a href="../reference/ph2simon.html">ph2simon</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print</span></span>
<span><span class="va">trial</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Simon 2-stage Phase II design </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Unacceptable response rate:  0.05 </span></span>
<span><span class="co">#&gt; Desirable response rate:  0.2 </span></span>
<span><span class="co">#&gt; Error rates: alpha =  0.1 ; beta =  0.1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         r1 n1 r  n EN(p0) PET(p0)</span></span>
<span><span class="co">#&gt; Optimal  0 12 3 37  23.49  0.5404</span></span>
<span><span class="co">#&gt; Minimax  0 18 3 32  26.44  0.3972</span></span></code></pre></div>
<p>This output provides the key components (<span class="math inline">\(r_1\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(n_1\)</span>, and <span class="math inline">\(n\)</span>) as well as <span class="math inline">\(EN(p_0)\)</span> and <span class="math inline">\(PET(p_0)\)</span> for the selected optimal and minimax designs (shown in the first and second rows, respectively).</p>
<p>As expected, the optimal design has a smaller expected sample size (<span class="math inline">\(EN(p_0)\)</span>; about 23 vs. 26), whereas the minimax design has a smaller maximum sample size (<span class="math inline">\(n\)</span>; 32 vs. 37).</p>
<p>We can also visualize these results. Using the base <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, plot the trial object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trial</span><span class="op">)</span></span></code></pre></div>
<p><img src="clinical-trial-functions_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>This output provides a visual representation of the maximum number of patients (<span class="math inline">\(n\)</span>) and expected sample size (<span class="math inline">\(EN(p_0)\)</span>) under various scenarios. O represents the optimal design, and M represents the minimax design.</p>
<p>The admissible design can be obtained by applying the <code><a href="../reference/twostage.admissible.html">twostage.admissible()</a></code> function to the trial object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain admissible design</span></span>
<span><span class="fu"><a href="../reference/twostage.admissible.html">twostage.admissible</a></span><span class="op">(</span><span class="va">trial</span><span class="op">)</span></span>
<span><span class="co">#&gt;            r1 n1 r  n   EN(p0)   PET(p0)   qLo   qHi</span></span>
<span><span class="co">#&gt; Minimax     0 18 3 32 26.43900 0.3972143 0.640 1.000</span></span>
<span><span class="co">#&gt; Admissible  0 15 3 33 24.66076 0.4632912 0.323 0.640</span></span>
<span><span class="co">#&gt; Admissible  0 13 3 35 23.70647 0.5133421 0.097 0.323</span></span>
<span><span class="co">#&gt; Optimal     0 12 3 37 23.49100 0.5403601 0.000 0.097</span></span></code></pre></div>
<p>This output includes the admissible design as well as the optimal and minimax designs. In addition to the design components seen earlier, columns <code>qLo</code> and <code>qHi</code> give the range of probability values for which the particular design is admissible.</p>
<p>For this particular trial, Tchekmedyian et al. opted for the minimax design. Thus, 18 patients were enrolled in stage 1 (<span class="math inline">\(n_1 = 18\)</span>). If no responses were observed (<span class="math inline">\(\leq 0\)</span> reduces to <span class="math inline">\(= 0\)</span> since the number of responses cannot be negative), then early termination would occur. Otherwise, if at least one response was observed, then 14 patients would be enrolled in stage 2 (<span class="math inline">\(n_2 = n - n_1 = 32 - 18 = 14\)</span>). At the end of stage 2, if at least 4 responses had been observed in total, then the treatment would be recommended; if 3 or fewer responses had been observed in total, then the treatment would not be recommended (<span class="math inline">\(r = 3\)</span>).</p>
<p>Ultimately, Tchekmedyian et al. observed four responses among the 18 patients enrolled in stage 1 and thus proceeded to stage 2, in which an additional 14 patients were enrolled. One response was observed among the stage 2 patients. Thus, at the end of the trial, 5 responses had been observed in total, and lenvatinib was recommended for further development in patients with progressive, recurrent or metastatic adenoid cystic carcinoma.</p>
</div>
<div class="section level4">
<h4 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h4>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/2702835/" class="external-link">Simon R. (1989). Optimal Two-Stage Designs for Phase II Clinical Trials. Controlled Clinical Trials 10, 1-10.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/11514038/" class="external-link">Jung SH, Carey M and Kim KM. (2001). Graphical Search for Two-Stage Designs for Phase II Clinical Trials. Controlled Clinical Trials 22, 367-372.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/14755389/" class="external-link">Jung SH, Lee T, Kim K, and George, SL. (2004). Admissible two-stage designs for phase II cancer clinical trials. Statistics in medicine 23(4), 561-569.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/30939095/" class="external-link">Tchekmedyian V, Sherman EJ, Dunn L, et al. (2019) Phase II Study of Lenvatinib in Patients With Progressive, Recurrent or Metastatic Adenoid Cystic Carcinoma. J Clin Oncol. 37(18):1529-1537.</a></p>
</div>
</div>
<div class="section level3">
<h3 id="single-stage">Single-Stage<a class="anchor" aria-label="anchor" href="#single-stage"></a>
</h3>
<p>A single-stage design may be used instead of a two-stage design when an endpoint requires too much time to evaluate or when early stopping is less of a priority.</p>
<p>The trial enrolls <span class="math inline">\(n\)</span> patients. After all patients have completed the study, if <span class="math inline">\(\leq r\)</span> responses have been observed in total, then the treatment is not recommended; if <span class="math inline">\(&gt;r\)</span> responses have been observed in total, then the treatment is recommended.</p>
<p>When designing a single-stage trial, the key objective is to select appropriate values of <span class="math inline">\(n\)</span> (sample size) and <span class="math inline">\(r\)</span> (response threshold at the end of the study). The response rate considered “unacceptable” (at which point a treatment would not be recommended) and the response rate considered “desirable” must be specified, and the values of <span class="math inline">\(r\)</span> and <span class="math inline">\(n\)</span> must be selected such that the desired error rate constraints are satisfied.</p>
<div class="section level4">
<h4 id="design-parameters-and-constraints-1">Design Parameters and Constraints<a class="anchor" aria-label="anchor" href="#design-parameters-and-constraints-1"></a>
</h4>
<p>In order to determine final design components, the following parameters and constraints must be specified:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): Treatment response rate considered unacceptable</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): Treatment response rate considered desirable</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): Type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): Type II error threshold</p></li>
</ul>
<p>The final design components depend on the response rates considered “unacceptable” (<span class="math inline">\(p_0\)</span>) and “desirable” (<span class="math inline">\(p_1\)</span>) and must satisfy the desired error rate constraints (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) for testing the following hypotheses:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true treatment response rate is less than or equal to some unacceptable level (<span class="math inline">\(p \leq p_0\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true treatment response rate is greater than or equal to some desirable level (<span class="math inline">\(p \geq p_1\)</span>)</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>For this example, we will be looking at a phase II trial that assessed the efficacy of everolimus in patients with thymoma and thymic carcinoma previously treated with cisplatin-based chemotherapy (Zucali et al., 2018). Patients received everolimus 10 mg/day. Treatment was continued until disease progression, death, unacceptable toxicity, or study discontinuation for any other reason. Treatment response was specifically defined as disease control: achievement of either partial response, complete response, or stable disease, as defined by Response Evaluation Criteria in Solid Tumors (RECIST) version 1.1.</p>
<p>The trial employed a single-stage design. A disease control rate of 40% was considered unacceptable, and a disease control rate of 60% was considered desirable. The type I error threshold used was 10%. The target power used was 90%, equivalent to a 10% type II error threshold.</p>
<p>Summarizing the design parameters and constraints from above, we have:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): 40% disease control rate</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): 60% disease control rate</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): 10% type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): 10% type II error threshold</p></li>
</ul>
<p>Thus, the hypotheses used for testing are:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true disease control rate is less than or equal to 40% (<span class="math inline">\(p \leq 0.4\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true disease control rate is greater than or equal to 60% (<span class="math inline">\(p \geq 0.6%\)</span>)</p></li>
</ul>
<p>Using <code><a href="../reference/ph2single.html">ph2single()</a></code>, specify the parameters and print the resulting object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the parameters and constraints &amp; print</span></span>
<span><span class="fu"><a href="../reference/ph2single.html">ph2single</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    n  r Type I error Type II error</span></span>
<span><span class="co">#&gt; 1 41 20   0.09651722    0.09651722</span></span>
<span><span class="co">#&gt; 2 43 21   0.09132412    0.09132412</span></span>
<span><span class="co">#&gt; 3 45 22   0.08645205    0.08645205</span></span>
<span><span class="co">#&gt; 4 47 23   0.08187654    0.08187654</span></span>
<span><span class="co">#&gt; 5 49 24   0.07757556    0.07757556</span></span></code></pre></div>
<p>This output provides the key components (<span class="math inline">\(n\)</span> and <span class="math inline">\(r\)</span>) for applicable designs as well as the type I and type II error rates corresponding to each of these designs.</p>
<p>Zucali et al. chose the first option listed, the design that enrolls the smallest number of patients (<span class="math inline">\(n = 41\)</span>) that still satisfies the error rate constraints. The treatment would be recommended if at least 21 of the first 41 evaluable patients achieved disease control (<span class="math inline">\(r = 20\)</span>). Ultimately, greater than 21 of these patients achieved disease control, and everolimus was recommended for further development in patients with thymoma and thymic carcinoma previously treated with cisplatin-based chemotherapy.</p>
</div>
<div class="section level4">
<h4 id="references-1">References<a class="anchor" aria-label="anchor" href="#references-1"></a>
</h4>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/29240542/" class="external-link">Zucali PA, De Pas T, Palmieri G, et al. (2018). Phase II Study of Everolimus in Patients With Thymoma and Thymic Carcinoma Previously Treated With Cisplatin-Based Chemotherapy. J Clin Oncol. 36(4):342-349.</a></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="calculating-sample-size-effect-size-and-power">Calculating Sample Size, Effect Size, and Power<a class="anchor" aria-label="anchor" href="#calculating-sample-size-effect-size-and-power"></a>
</h2>
<div class="section level3">
<h3 id="fishers-exact-test">Fisher’s Exact Test<a class="anchor" aria-label="anchor" href="#fishers-exact-test"></a>
</h3>
<p>{clinfun} offers a set of functions to determine sample sizes, effect sizes, and power based on Fisher’s exact tests. Below is a table summarizing the functions based on Fisher’s exact test.</p>
<table class="table">
<colgroup>
<col width="22%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Details</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/fedesign.html">fe.ssize()</a></code></td>
<td>Returns a 2x3 matrix with Casagrande, Pike, Smith (CPS) and Fisher’s exact sample sizes with power.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/fedesign.html">fe.mdor()</a></code></td>
<td>Returns a 3x2 matrix with Schlesselman, CPS and Fisher’s exact minimum detectable odds ratios and the corresponding power.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/fedesign.html">fe.power()</a></code></td>
<td>Returns a Kx2 matrix with probabilities (p2) and exact power.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/fedesign.html">CPS.ssize()</a></code></td>
<td>Returns CPS sample size, which is a very close to the exact. Use this for small differences p2-p1 (hence large sample sizes) to get the result instantaneously.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/fedesign.html">mdrr()</a></code></td>
<td>Computes the minimum detectable P(resp given marker+) and P(resp given marker-) configurations when total sample size (n), P(response) (presp) and proportion of subjects who are marker positive (cprob) are specified.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/fedesign.html">or2pcase()</a></code></td>
<td>Gives the probability of disease among the cases for a given probability of disease in controls (pcontrol) and odds ratio (OR).</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fedesign.html">fe.ssize</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.2</span>, p2 <span class="op">=</span> <span class="fl">0.3</span>, power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Group 1 Group 2 Exact Power</span></span>
<span><span class="co">#&gt; CPS              313     313   0.8018729</span></span>
<span><span class="co">#&gt; Fisher Exact     311     311   0.8004486</span></span></code></pre></div>
<p><em>CAUTION:</em> As we can see below, when we use base R <code><a href="https://rdrr.io/r/stats/power.prop.test.html" class="external-link">power.prop.test()</a></code>, we obtain an incorrect result due to normal approximation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/power.prop.test.html" class="external-link">power.prop.test</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.2</span>, p2 <span class="op">=</span> <span class="fl">0.3</span>, power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Two-sample comparison of proportions power calculation </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               n = 293.1513</span></span>
<span><span class="co">#&gt;              p1 = 0.2</span></span>
<span><span class="co">#&gt;              p2 = 0.3</span></span>
<span><span class="co">#&gt;       sig.level = 0.05</span></span>
<span><span class="co">#&gt;           power = 0.8</span></span>
<span><span class="co">#&gt;     alternative = two.sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NOTE: n is number in *each* group</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="references-2">References<a class="anchor" aria-label="anchor" href="#references-2"></a>
</h4>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/719125/" class="external-link">Casagrande JT, Pike MC, Smith PG. (1978). An improved approximate formula for calculating sample sizes for comparing two binomial distributions. Biometrics 34, 483-486.</a></p>
<p>Fleiss, JL. (1981). Statistical Methods for Rates and Proportions.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/3812441/" class="external-link">Schlesselman JJ. (1987) Re: Smallest detectable relative risk with multiple controls per case. Am J Epidemiol 125(2), 348.</a></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Venkatraman E. Seshan, Karissa Whiting.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
